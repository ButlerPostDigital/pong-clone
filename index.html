<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.3">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc; background-color: #171818}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc; background-color: #171818; min-height: 16.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;Retro Pong + AI&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>:root {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--bg-color: #051005;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--game-bg: #000000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--accent: #33ff33;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--text-color: #33ff33;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--commentary-bg: #000000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>body {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: var(--bg-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--text-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>flex-direction: column;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: 100vh;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-family: 'Courier New', Courier, monospace;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>overflow: hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: background-color 0.5s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.container {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>position: relative;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 20px rgba(0,0,0,0.5);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 4px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>overflow: hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>max-width: 800px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>aspect-ratio: 4/3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background: var(--game-bg);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: background-color 0.5s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>canvas {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: block;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: var(--game-bg);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: background-color 0.5s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.ui-layer {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>position: absolute;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>top: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>left: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>pointer-events: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>flex-direction: column;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.score-board {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>position: absolute;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>top: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 4rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-weight: bold;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>opacity: 0.5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>pointer-events: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gap: 100px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--text-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: color 0.5s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/* Commentary Bubble */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.commentary-box {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>position: absolute;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>bottom: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 80%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>min-height: 40px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background: rgba(0, 0, 0, 0.8);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: 2px solid var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 10px 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-transform: uppercase;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 4px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>opacity: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: opacity 0.3s, color 0.5s, border-color 0.5s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.commentary-box.visible {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>opacity: 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.start-screen, .game-over-screen, .theme-modal {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background: rgba(0, 0, 0, 0.9);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 2rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>pointer-events: auto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: opacity 0.3s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: 1px solid var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>max-width: 80%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>h1 {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin: 0 0 1rem 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 2.5rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-transform: uppercase;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>letter-spacing: 4px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-shadow: 0 0 10px var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: color 0.5s, text-shadow 0.5s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>p {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 1.1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>line-height: 1.5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-bottom: 2rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--text-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>opacity: 0.8;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: color 0.5s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>button {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background: var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--game-bg);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 12px 30px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 1.2rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-family: inherit;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-weight: bold;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-transform: uppercase;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 2px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: transform 0.1s, background-color 0.2s, color 0.5s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin: 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>button:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transform: scale(1.05);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>filter: brightness(1.2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>button:active {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transform: scale(0.95);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>button:disabled {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>opacity: 0.5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cursor: not-allowed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transform: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>input[type="text"] {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background: transparent;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: 2px solid var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-family: inherit;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>box-sizing: border-box;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>outline: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>input[type="text"]::placeholder {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>opacity: 0.5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.controls-hint {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-top: 15px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 0.8rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>opacity: 0.7;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--text-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/* Pause Button &amp; Overlay */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.pause-btn {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>position: absolute;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>top: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>right: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background: transparent;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: 2px solid var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 40px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: 40px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 50%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-weight: bold;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>z-index: 20;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>opacity: 0.5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: opacity 0.3s, transform 0.2s, background-color 0.3s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>pointer-events: auto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.pause-btn:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>opacity: 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transform: scale(1.1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background: rgba(255, 255, 255, 0.1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.pause-overlay {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background: rgba(0, 0, 0, 0.4);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>backdrop-filter: blur(2px);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.scanlines {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>position: absolute;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>top: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>left: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background: linear-gradient(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>to bottom,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>rgba(255, 255, 255, 0),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>rgba(255, 255, 255, 0) 50%,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>rgba(0, 0, 0, 0.2) 50%,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>rgba(0, 0, 0, 0.2)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-size: 100% 4px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>pointer-events: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>z-index: 10;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.hidden {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: none !important;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.loading {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>animation: blink 1s infinite;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>@keyframes blink {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>0%, 100% { opacity: 1; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>50% { opacity: 0.5; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="container" id="gameContainer"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;canvas id="gameCanvas" width="800" height="600"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="scanlines"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="score-board"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;span id="playerScore"&gt;0&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;span id="aiScore"&gt;0&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button id="pauseBtn" class="pause-btn hidden"&gt;||&lt;/button&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="commentaryBox" class="commentary-box"&gt;AI: "PREPARE TO BE DELETED."&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Start Screen --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="startScreen" class="ui-layer"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="start-screen"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h1&gt;PONG&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p&gt;First to 5 points wins.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="startBtn"&gt;Start Game&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="themeBtn"&gt;✨ AI Theme&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="controls-hint"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>Controls: Mouse / Touch / Arrow Keys</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Theme Modal --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="themeModal" class="ui-layer hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="theme-modal"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h1&gt;Dream Theme&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p&gt;Describe a style (e.g., "Cyberpunk", "80s Sunset", "Matrix")&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input type="text" id="themeInput" placeholder="Enter theme description..."&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="generateThemeBtn"&gt;Generate&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="cancelThemeBtn" style="background: transparent; border: 1px solid var(--accent); color: var(--accent);"&gt;Cancel&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Pause Screen --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="pauseScreen" class="ui-layer hidden pause-overlay"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="start-screen"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h1&gt;PAUSED&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button id="resumeBtn"&gt;Resume&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Game Over Screen --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="gameOverScreen" class="ui-layer hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="game-over-screen"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h1 id="winnerText"&gt;Player Wins!&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button id="restartBtn"&gt;Play Again&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* Pong Game Logic with Gemini API Integration</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- Gemini API Setup ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const apiKey = "AIzaSyBj14Ny1_4pgz4AIVISdnJn-tFa7aHVbAM"; // System will provide API key at runtime</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function callGemini(prompt, systemInstruction, jsonMode = false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const payload = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>contents: [{ parts: [{ text: prompt }] }],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>systemInstruction: { parts: [{ text: systemInstruction }] }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (jsonMode) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>payload.generationConfig = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>responseMimeType: "application/json",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>responseSchema: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>type: "OBJECT",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>properties: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>bg_color: { type: "STRING" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>game_bg: { type: "STRING" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>accent: { type: "STRING" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>text_color: { type: "STRING" }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const response = await fetch(url, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>method: 'POST',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>headers: { 'Content-Type': 'application/json' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>body: JSON.stringify(payload)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!response.ok) throw new Error(`API Error: ${response.status}`);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const data = await response.json();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return data.candidates?.[0]?.content?.parts?.[0]?.text;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("Gemini API Error:", error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- Configuration ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const CONFIG = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>paddleWidth: 15,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>paddleHeight: 100,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ballSize: 10,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>winScore: 5,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>initialBallSpeed: 5,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>speedIncrease: 0.5,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>aiSpeed: 5</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- State Management ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const canvas = document.getElementById('gameCanvas');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const ctx = canvas.getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const container = document.getElementById('gameContainer');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// UI Elements</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const startScreen = document.getElementById('startScreen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const gameOverScreen = document.getElementById('gameOverScreen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const themeModal = document.getElementById('themeModal');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const startBtn = document.getElementById('startBtn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const restartBtn = document.getElementById('restartBtn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const themeBtn = document.getElementById('themeBtn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const generateThemeBtn = document.getElementById('generateThemeBtn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const cancelThemeBtn = document.getElementById('cancelThemeBtn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const themeInput = document.getElementById('themeInput');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const playerScoreEl = document.getElementById('playerScore');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const aiScoreEl = document.getElementById('aiScore');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const winnerText = document.getElementById('winnerText');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const commentaryBox = document.getElementById('commentaryBox');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Pause Elements</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const pauseBtn = document.getElementById('pauseBtn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const pauseScreen = document.getElementById('pauseScreen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const resumeBtn = document.getElementById('resumeBtn');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let animationId;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let isGameRunning = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let isPaused = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let serveTimeout;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let currentTheme = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>accent: '#33ff33',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>game_bg: '#000000',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ball: '#33ff33',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>player: '#33ff33',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ai: '#33ff33'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Game Objects</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const ball = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>x: canvas.width / 2,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>y: canvas.height / 2,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>radius: CONFIG.ballSize,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>speedX: CONFIG.initialBallSpeed,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>speedY: CONFIG.initialBallSpeed,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>speed: CONFIG.initialBallSpeed</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const player = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>x: 0,<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>y: (canvas.height - CONFIG.paddleHeight) / 2,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: CONFIG.paddleWidth,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: CONFIG.paddleHeight,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>score: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>dy: 0 // Velocity for keyboard controls</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const ai = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>x: canvas.width - CONFIG.paddleWidth,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>y: (canvas.height - CONFIG.paddleHeight) / 2,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: CONFIG.paddleWidth,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: CONFIG.paddleHeight,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>score: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>dy: 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- AI Commentary Logic ---</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function triggerCommentary(eventType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Rate limiting/randomness to avoid spamming every single event</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (eventType === 'rally' &amp;&amp; Math.random() &gt; 0.3) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const systemPrompt = "You are a competitive, slightly arrogant 1980s retro computer AI named 'CPU-001' playing Pong against a human. Speak in all-caps, short sentences (max 8 words). Use technical/glitchy jargon. Be sarcastic if you lose, gloat if you win.";</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let userPrompt = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>switch(eventType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>case 'start': userPrompt = "The game has just started. Intimidate the human."; break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>case 'ai_score': userPrompt = `I just scored. Current score: CPU ${ai.score}, Human ${player.score}. Gloat.`; break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>case 'player_score': userPrompt = `The human just scored. Current score: CPU ${ai.score}, Human ${player.score}. Make an excuse or insult them.`; break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>case 'win': userPrompt = "I won the match. Celebrate my superiority."; break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>case 'loss': userPrompt = "I lost the match. Claim it was a bug or hardware failure."; break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>case 'rally': userPrompt = "The rally has been going on for a long time. Comment on the intensity."; break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Show loading...</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>commentaryBox.textContent = "CPU-001 IS THINKING...";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>commentaryBox.classList.add('visible');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const text = await callGemini(userPrompt, systemPrompt);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (text) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>commentaryBox.textContent = `CPU: "${text.replace(/"/g, '')}"`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Hide after 4 seconds</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Only hide if text hasn't changed</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (commentaryBox.textContent.includes(text.replace(/"/g, ''))) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>commentaryBox.classList.remove('visible');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}, 4000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- Theme Logic ---</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function generateTheme() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const description = themeInput.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!description) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>generateThemeBtn.textContent = "Generating...";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>generateThemeBtn.disabled = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const systemPrompt = "You are a UI design assistant. Generate a color palette for a retro pong game based on the user's description. Return strictly JSON.";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const userPrompt = `Create a theme for: "${description}". Needs 4 colors: bg_color (page background), game_bg (canvas background), accent (paddles/text/ball), text_color.`;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const jsonStr = await callGemini(userPrompt, systemPrompt, true);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (jsonStr) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const theme = JSON.parse(jsonStr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>applyTheme(theme);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>closeThemeModal();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>console.error("Failed to parse theme", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>generateThemeBtn.textContent = "Generate";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>generateThemeBtn.disabled = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function applyTheme(theme) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const root = document.documentElement;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>root.style.setProperty('--bg-color', theme.bg_color || '#000');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>root.style.setProperty('--game-bg', theme.game_bg || '#111');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>root.style.setProperty('--accent', theme.accent || '#fff');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>root.style.setProperty('--text-color', theme.text_color || '#fff');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Update JS internal colors</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>currentTheme.accent = theme.accent || '#fff';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>currentTheme.game_bg = theme.game_bg || '#111';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>currentTheme.ball = theme.accent || '#fff';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>currentTheme.player = theme.accent || '#fff';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>currentTheme.ai = theme.accent || '#fff';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- Game Flow ---</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function init() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>resetBall();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>player.score = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ai.score = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>updateScoreBoard();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>player.x = 20;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ai.x = canvas.width - 20 - CONFIG.paddleWidth;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>triggerCommentary('start');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function gameLoop() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isGameRunning) return;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isPaused) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>update();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>draw();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>animationId = requestAnimationFrame(gameLoop);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function start() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>startScreen.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gameOverScreen.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>themeModal.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>pauseScreen.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>pauseBtn.classList.remove('hidden'); // Show pause button</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>isGameRunning = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>isPaused = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>init();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gameLoop();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function togglePause() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isGameRunning) return;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>isPaused = !isPaused;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (isPaused) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>pauseScreen.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>pauseBtn.textContent = '▶';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>pauseScreen.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>pauseBtn.textContent = '||';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function stop(winner) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>isGameRunning = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>pauseBtn.classList.add('hidden'); // Hide pause button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cancelAnimationFrame(animationId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (serveTimeout) clearTimeout(serveTimeout);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>winnerText.textContent = winner === 'player' ? "YOU WIN!" : "GAME OVER";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gameOverScreen.classList.remove('hidden');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>triggerCommentary(winner === 'player' ? 'loss' : 'win');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let rallyCount = 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function update() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (player.dy !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>player.y += player.dy;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (player.y &lt; 0) player.y = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (player.y + player.height &gt; canvas.height) player.y = canvas.height - player.height;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// AI Movement</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let aiCenter = ai.y + ai.height / 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (aiCenter &lt; ball.y - 35) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ai.y += CONFIG.aiSpeed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (aiCenter &gt; ball.y + 35) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ai.y -= CONFIG.aiSpeed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (ai.y &lt; 0) ai.y = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (ai.y + ai.height &gt; canvas.height) ai.y = canvas.height - ai.height;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Ball Movement</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ball.x += ball.speedX;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ball.y += ball.speedY;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (ball.y - ball.radius &lt; 0 || ball.y + ball.radius &gt; canvas.height) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ball.speedY = -ball.speedY;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let activePaddle = (ball.x &lt; canvas.width / 2) ? player : ai;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (collision(ball, activePaddle)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let collidePoint = (ball.y - (activePaddle.y + activePaddle.height / 2));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>collidePoint = collidePoint / (activePaddle.height / 2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let angleRad = (Math.PI / 4) * collidePoint;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let direction = (ball.x &lt; canvas.width / 2) ? 1 : -1;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ball.speed += CONFIG.speedIncrease;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ball.speedX = direction * ball.speed * Math.cos(angleRad);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ball.speedY = ball.speed * Math.sin(angleRad);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>rallyCount++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (rallyCount === 10) triggerCommentary('rally');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Scoring</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (ball.x - ball.radius &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ai.score++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>triggerCommentary('ai_score');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateScoreBoard();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>checkWinCondition();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>resetBall();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (ball.x + ball.radius &gt; canvas.width) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>player.score++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>triggerCommentary('player_score');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateScoreBoard();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>checkWinCondition();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>resetBall();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function collision(b, p) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return b.x + b.radius &gt; p.x &amp;&amp;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                   </span>b.x - b.radius &lt; p.x + p.width &amp;&amp;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                   </span>b.y + b.radius &gt; p.y &amp;&amp;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                   </span>b.y - b.radius &lt; p.y + p.height;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function resetBall() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>rallyCount = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ball.x = canvas.width / 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ball.y = canvas.height / 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ball.speed = CONFIG.initialBallSpeed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ball.speedX = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ball.speedY = 0;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (serveTimeout) clearTimeout(serveTimeout);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>serveTimeout = setTimeout(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!isGameRunning) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>launchBall();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, 3000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function launchBall() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ball.speedX = (Math.random() &gt; 0.5 ? 1 : -1) * ball.speed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ball.speedY = (Math.random() * 2 - 1) * ball.speed * 0.5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function checkWinCondition() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (player.score &gt;= CONFIG.winScore) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stop('player');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (ai.score &gt;= CONFIG.winScore) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stop('ai');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function updateScoreBoard() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>playerScoreEl.textContent = player.score;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>aiScoreEl.textContent = ai.score;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- Rendering ---</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function draw() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Clear Screen with current theme color</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.fillStyle = currentTheme.game_bg;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.fillRect(0, 0, canvas.width, canvas.height);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>drawNet();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>drawRect(player.x, player.y, player.width, player.height, currentTheme.player);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>drawRect(ai.x, ai.y, ai.width, ai.height, currentTheme.ai);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>drawCircle(ball.x, ball.y, ball.radius, currentTheme.ball);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function drawRect(x, y, w, h, color) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.fillStyle = color;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.fillRect(x, y, w, h);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function drawCircle(x, y, r, color) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.fillStyle = color;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.beginPath();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.arc(x, y, r, 0, Math.PI * 2, false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.closePath();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.fill();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function drawNet() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.strokeStyle = currentTheme.accent;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.globalAlpha = 0.2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.lineWidth = 4;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.setLineDash([15, 10]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.beginPath();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.moveTo(canvas.width / 2, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.lineTo(canvas.width / 2, canvas.height);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.stroke();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.setLineDash([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx.globalAlpha = 1.0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- Input Handling ---</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>container.addEventListener('mousemove', (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isGameRunning || isPaused) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const rect = canvas.getBoundingClientRect();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const scaleY = canvas.height / rect.height;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const relativeY = (e.clientY - rect.top) * scaleY;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>player.y = relativeY - player.height / 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>container.addEventListener('touchmove', (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isGameRunning || isPaused) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.preventDefault();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const rect = canvas.getBoundingClientRect();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const scaleY = canvas.height / rect.height;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const touch = e.touches[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const relativeY = (touch.clientY - rect.top) * scaleY;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>player.y = relativeY - player.height / 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}, { passive: false });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.addEventListener('keydown', (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Toggle pause with 'P'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (isGameRunning &amp;&amp; (e.key === 'p' || e.key === 'P')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>togglePause();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isGameRunning || isPaused) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (e.key === 'ArrowUp' || e.key === 'w' || e.key === 'W') player.dy = -8;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>else if (e.key === 'ArrowDown' || e.key === 's' || e.key === 'S') player.dy = 8;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.addEventListener('keyup', (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (e.key === 'ArrowUp' || e.key === 'w' || e.key === 'W' ||<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>e.key === 'ArrowDown' || e.key === 's' || e.key === 'S') player.dy = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Button Event Listeners</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>startBtn.addEventListener('click', start);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>restartBtn.addEventListener('click', start);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>pauseBtn.addEventListener('click', togglePause);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>resumeBtn.addEventListener('click', togglePause);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Theme UI</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>themeBtn.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>startScreen.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>themeModal.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>cancelThemeBtn.addEventListener('click', closeThemeModal);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function closeThemeModal() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>themeModal.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isGameRunning) startScreen.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>generateThemeBtn.addEventListener('click', generateTheme);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Initial Draw</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>draw();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
